<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
    <title>i18n-number Demo</title>
    <script src="../../webcomponentsjs/webcomponents-lite.min.js"></script>
    <link rel="import" href="../../iron-flex-layout/iron-flex-layout.html">
    <link rel="import" href="../../paper-input/paper-input.html">
    <link rel="import" href="../../paper-dropdown-menu/paper-dropdown-menu.html">
    <link rel="import" href="../../paper-menu/paper-menu.html">
    <link rel="import" href="../../paper-item/paper-item.html">
    <link rel="import" href="../../paper-styles/demo-pages.html">
    <link rel="import" href="../../paper-input-autocomplete/paper-input-autocomplete.html">
    <link rel="import" href="../i18n-number.html">
    <link rel="import" href="editable-dropdown-menu.html">
    <link rel="import" href="nano-calc.html">
    <link rel="import" href="currency-list.html">
    <style is="custom-style">
      paper-item {
        display: block;
      }

      code {
        font-family: Consolas, 'Courier New', Courier, Monaco, monospace;
        color: black;
      }

      .dropdown {
        --editable-dropdown-menu: {
          display: inline-block;
          margin-right: 8px;
          text-align: left;
          width: 180px;
        };
      }

      .demo-paper-dropdown-menu {
        font-family: 'Roboto', 'Noto', Helvetica, sans-serif;
        font-size: 16px;
        font-weight: 400;
        line-height: 24px;
        text-align: left;
        margin: auto;
        width: 180px;
      }

      @media (max-width: 640px) {

        body {
          font-size: 14px;
          margin: 0;
          padding: 4px;
          background-color: var(--paper-grey-50);
        }

        .horizontal-section {
          background-color: white;
          padding: 8px;
          margin-right: 4px;
          min-width: 200px;

          @apply(--shadow-elevation-2dp);
        }

        .vertical-section {
          background-color: white;
          padding: 8px;
          margin: 0 4px 8px 4px;

          @apply(--shadow-elevation-2dp);
        }

      }
    </style>
  </head>
  <body>
    <h1><code>&lt;i18n-number&gt;</code> Demo</h1>

    <div class="vertical-section-container">
      <div class="vertical-section">
        <h2>Currency - USD in en</h2>
        <i18n-number 
          lang="en"
          options='{ "style": "currency", "currency": "USD" }' 
          offset="1">123456.789</i18n-number>
        <h2>Number in en</h2>
        <i18n-number lang="en">123456.789</i18n-number>
      </div>
      <div class="vertical-section">
        <template is="dom-bind" id="demo">
          <h2>Parameters<h2>
          <h3>Number</h3>
          <paper-input label="Raw number input" 
                      auto-validate
                      pattern="[0-9]*([.][0-9]*)?"
                      error-message="Number only!"
                      value="{{rawNumber}}"></paper-input>
          <h3>Language</h3>
          <editable-dropdown-menu id="lang-attr"
                              label="lang"
                              class="dropdown"
                              pattern="[a-zA-Z][a-zA-Z-]*"
                              error-message="locale name expected!"
                              items="{{parameterValues.lang}}"
                              value="{{lang}}"
                              editable
                              default-value="{{parameterValues.lang.0.value}}">
          </editable-dropdown-menu>
          <h3>Options</h3>
          <editable-dropdown-menu id="style-option"
                              label="style"
                              class="dropdown"
                              pattern="[a-zA-Z]*"
                              items="{{parameterValues.style}}"
                              value="{{options.style}}"
                              default-value="{{parameterValues.style.0.value}}">
          </editable-dropdown-menu>
          <editable-dropdown-menu id="currency-option"
                              label="currency"
                              class="dropdown"
                              pattern="[a-zA-Z]*"
                              items="{{parameterValues.currency}}"
                              value="{{options.currency}}"
                              default-value="USD"
                              editable
                              disabled="{{_disableCurrencyOptions(options.style)}}">
          </editable-dropdown-menu>

          <paper-input-autocomplete id="currency-display-option"
            label="currencyDisplay"
            class="demo-paper-dropdown-menu"
            source="{{parameterValues.currencyDisplay}}"
            value="{{_currencyDisplayObject}}"
            search-property="label"
            suggestions-in-overlay>
          </paper-input-autocomplete>
          <h2>Output<h2>
          <i18n-number lang="{{lang}}" options="{{options}}">{{rawNumber}}</i18n-number>
        </template>
        <script>
          var currencyList = document.createElement('currency-list');
          var labelList = currencyList.labelList;
          function mixin (base, extend) {
            for (var i in extend) {
              base[i] = extend[i];
            }
          }
          mixin(demo, {
            properties: {
              rawNumber: {
                type: String,
                value: '12.34'
              },
              options: {
                type: Object,
                value: function () { 
                  return { 
                    style: 'decimal', 
                    currency: 'USD', 
                    currencyDisplay: 'symbol' 
                  };
                }
              },
              lang: {
                type: String,
                value: 'en',
                observer: 'langChanged'
              },
              _currencyDisplayObject: {
                type: Object,
                observer: '_currencyDisplayObjectChanged'
              },
              parameterValues: {
                type: Object,
                value: function () {
                  return {
                    lang: [
                      { value: 'en', label: 'en English (US)' },
                      { value: 'en-GB', label: 'en-GB English (UK)' },
                      { value: 'ja', label: 'ja Japanese' },
                      { value: 'fr', label: 'fr French' }
                    ],
                    style: [
                      { value: 'decimal', label: 'decimal' },
                      { value: 'currency', label: 'currency' },
                      { value: 'percent', label: 'percent' }
                    ],
                    currency: labelList,
                    currencyDisplay: [
                      { value: 'symbol', label: 'symbol' },
                      { value: 'name', label: 'name' }
                    ]
                  };
                }
              }
            },

            observers: [
            ],

            listeners: {
              'dom-change': 'domChanged'
            },

            _disableCurrencyOptions: function (style) {
              return style !== 'currency';
            },

            behaviors: [
              {
                attached: function () {
                  console.log('demo: attached lang = ' + demo.lang);
                }
              }
            ],

            langChanged: function (v) {
              console.log('langChanged: lang = ' + v);
            },

            domChanged: function () {
              
              demo.parameterValues.currency = currencyList.labelList;
              demo.parameterValues.currency.push({ value: '+', label: 'New...' });
              demo.notifyPath('parameterValues', demo.parameterValues, true);
              this.unlisten('dom-change', this.domChanged);
            },

            _currencyDisplayObjectChanged: function (obj) {
              demo.options.currencyDisplay = obj.value;
              demo.notifyPath('options', demo.options, true);
            }

          });
        </script>
      </div>
      <div class="vertical-section">
        <h2><code>&lt;nano-calc&gt;</code></h2>

        <nano-calc></nano-calc>
      </div>
    </div>
  </body>
</html>
